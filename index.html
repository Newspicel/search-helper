<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Search Helper</title>
  </head>
  <body>
    <input type="text" id="search" placeholder="Search..." style="width: 100%; text-align: center; height: 50px; font-size: larger" />
    <div id="search-info" style="text-align: center; font-size: medium"></div>
    <div id="search-results">
      <p>Type for Result</p>
    </div>
    <script text="text/javascript" src="engines.js"></script>
    <script>
      var search = document.getElementById("search");

      window.addEventListener("load", () => {
        const params = new URLSearchParams(window.location.search);
        const searchParam = params.get("q");

        if (searchParam) {
          search.value = searchParam;
          searchEngine(searchParam);
        }
      });

      search.addEventListener("input", () => {
        searchEngine(search.value);
      });

      function searchEngine(query) {
        var searchInfo = document.getElementById("search-info");
        var searchResults = document.getElementById("search-results");

        searchInfo.innerHTML = "Searching...";
        searchResults.innerHTML = "";

        searchInfo.innerHTML = "Searching for " + query + "...";
        var queryKey = encodeURIComponent(query);

        var searchResult = "";

        searchEngines.forEach(function (searchEngine) {
          var innerSearchResults = "";

          innerSearchResults += "<h3>" + searchEngine.name + "</h3>";

          searchEngine.engines.forEach(function (searchEngineEngine) {
            innerSearchResults += "<li><a target='_blank' href='" + searchEngineEngine.url.replace("{0}", encodeURIComponent(query)) + "'>" + searchEngineEngine.name + " (" + searchEngineEngine.info + ")" + "</a></li>";
          });

          searchResult += "<div class='search-category'>" + innerSearchResults + "</div>";
        });

        searchResults.innerHTML = searchResult;
      }
    </script>

    <footer>
      <p>&copy; 2021 <a href="https://twitter.com/newspicel" target="_blank">Newspicel</a></p>
      <a href="https://github.com/newspicel/search-helper" target="_blank"><img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/newspicel/search-helper?style=social"></a>
    </footer>
  </body>
</html>
